-- CR9020 メッセージダウンロードSQL
SET ECHO OFF
SET FEEDBACK OFF
SET HEADING OFF
SET WRAP OFF
SET NEWPAGE NONE
SET PAGESIZE 0
SET TERMOUT OFF
SET TIMI OFF
SET LINE 4253
COLUMN ID90400 FORMAT A255
COLUMN DH90400 FORMAT A1999
COLUMN DH90401 FORMAT A1999

--spool MESSAGE.dat
spool &1

SELECT
    TO_CHAR(S1.DH90305) AS ID90400,
    NVL(TO_CHAR(S2.DH90305), ' ') AS DH90400,
    NVL(TO_CHAR(S3.DH90305), ' ') AS DH90401
FROM
    (SELECT
        *
    FROM
        CR9060
    WHERE
        ID_CR9061=31 AND
        INVALID_FLAG=0
    ) R,
    (SELECT
        *
    FROM
        CR9062
    WHERE
        ID_CR9063=301
    ) S1,
    (SELECT
        *
    FROM
        CR9062
    WHERE
        ID_CR9063=302
    ) S2,
    (SELECT
        *
    FROM
        CR9062
    WHERE
        ID_CR9063=303
    ) S3
WHERE
    R.ID_CR9060 = S1.ID_CR9060 AND
    R.ID_CR9060 = S2.ID_CR9060 AND
    R.ID_CR9060 = S3.ID_CR9060(+)
    --AND ROWNUM < 20
ORDER BY
    R.ID_CR9060
/
spool off

exit
